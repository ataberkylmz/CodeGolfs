*b;t,x;main(z,v,n)char**v;{n=atoi(v[1]);b=malloc(4*n);q(0,n);printf("%d\n", t);}a(z){return z<0?-z:z;}d(n,i,j){t++;for(i=n;i--;){for(j=n;j--;)printf("%c ",b[i]^j?'.':'Q');puts();}puts();}p(r,c,x,i){for(i=r;i--;)x=(b[i]^c)?(a(b[i]-c)^a(i-r))?x:0:0;x=!!x;}q(r,n,c){for(c=n;c--;)if(p(r,c,1))b[r]=c,r^n-1?q(r+1,n):d(n);}